<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>323 Web Emulator</title>
    <script type="module" src="./index.dist.js"></script>

    <meta
      name="description"
      content="An emulator for the 323 - a 32-bit computer in the Conway's Game of Life"
    >

    <meta name="author" content="Rei" />

    <link rel="canonical" href="https://rei1024.github.io/323-web-emulator/" />

    <link rel="icon" href="./favicon.svg" type="image/svg+xml">

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    >
    <link rel="stylesheet" href="./style.min.css">
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="container">
    <header>
      <h1 class="text-center">323 Web Emulator</h1>
    </header>
    <main>
      <noscript class="alert alert-danger" role="alert">
        This application requires JavaScript to be enabled.
      </noscript>
      <input id="select-file" type="file" class="d-none" accept=".323,.txt" />
      <label for="select-file" class="mb-2 btn btn-primary btn-sm">
        <!-- https://icons.getbootstrap.com/icons/upload/ -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-upload"
          viewBox="0 0 16 16"
        >
          <path
            stroke="currentColor"
            stroke-width="0.5"
            d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"
          />
          <path
            stroke="currentColor"
            stroke-width="0.5"
            d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"
          />
        </svg>
        Select file (.323)
      </label>
      <section class="mb-3">
        <label for="assembly-input-textarea" class="visually-hidden form-label"
        >323 assembly input</label>
        <textarea
          spellcheck="false"
          class="font-monospace form-control"
          name="assembly-input-textarea"
          id="assembly-input-textarea"
          cols="50"
          rows="8"
          placeholder="; 323 Assembly language"
        ></textarea>
      </section>
      <div
        data-test="control_buttons"
        class="btn-group"
        role="group"
        aria-label="Control"
      >
        <button
          id="reset"
          type="button"
          class="btn btn-primary"
          disabled
        >
          <!-- https://icons.getbootstrap.com/icons/arrow-clockwise/ -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="16"
            height="16"
            fill="currentColor"
            class="bi bi-arrow-clockwise"
            viewBox="0 0 16 16"
          >
            <path
              stroke="currentColor"
              stroke-width="0.5"
              fill-rule="evenodd"
              d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"
            />
            <path
              d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"
            />
          </svg>
          Reset
        </button>
        <button
          id="toggle"
          type="button"
          class="btn btn-primary"
          disabled
        >
          Run
        </button>
        <button
          id="step-button"
          type="button"
          class="btn btn-primary"
          disabled
        >
          <span id="step-text">Step</span>
        </button>
      </div>
      <div
        id="message"
        class="mt-3 d-none alert alert-danger tabular-nums"
        role="alert"
      >
      </div>
      <div class="mt-1 mb-2 d-flex flex-row gap-1">
        <label for="frequency-input" class="form-label m-0"><pre
            id="frequency-output"
            class="tabular-nums"
          >30Hz</pre></label>
        <input
          id="frequency-input"
          class="form-range"
          value="11"
          type="range"
          max="65"
        />
      </div>
      <section class="mb-1">
        PC: <span id="program-counter" class="font-monospace"></span>
        Step number: <span id="step-number" class="font-monospace"></span>
        Flag: <span id="flag" class="font-monospace"></span>
        <br class="d-inline d-md-none">Current instruction: <span
          id="current-instruction"
          class="font-monospace"
        ></span>
      </section>
      <section>
        <div>
          Registers:

          <input
            type="checkbox"
            class="btn-check"
            id="register-dec"
            autocomplete="off"
            checked
          >
          <label class="btn" for="register-dec">Dec</label>
          <input
            type="checkbox"
            class="btn-check"
            id="register-hex"
            autocomplete="off"
          >
          <label class="btn" for="register-hex">Hex</label>
        </div>

        <div id="registers"></div>
      </section>

      <section class="mb-1 d-flex flex-sm-row flex-column gap-2">
        <div>
          <div>
            Display:
          </div>
          <canvas width="250" height="250" id="display-canvas"></canvas>
        </div>
        <div>
          <div>
            Input:
          </div>
          <div class="arrow-buttons">
            <div class="arrow-row">
              <button id="key-up" class="btn btn-light">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-arrow-up"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5"
                  />
                </svg>
              </button>
            </div>
            <div class="arrow-row">
              <button id="key-left" class="btn btn-light">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-arrow-left"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"
                  />
                </svg>
              </button>
              <div class="arrow-spacer"></div>
              <button id="key-right" class="btn btn-light">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-arrow-right"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"
                  />
                </svg>
              </button>
            </div>
            <div class="arrow-row">
              <button id="key-down" class="btn btn-light">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-arrow-down"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M8 1a.5.5 0 0 1 .5.5v11.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0l-4-4a.5.5 0 0 1 .708-.708L7.5 13.293V1.5A.5.5 0 0 1 8 1"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </section>
      <section>
        <details id="ram-details">
          <summary>RAM</summary>
          <small>hword order (lower 16 bits + higher 16 bits)</small>
          <div id="ram">
            <!-- <table>
              <tr>
                <th>0x0000</th>
                <td>
                  FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF
                  FFFF FFFF FFFF FFFF
                </td>
              </tr>
            </table> -->
          </div>
        </details>
      </section>
    </main>
    <footer class="mt-3">
      <section>
        <h2 class="fs-4 mt-3">Links</h2>
        <ul>
          <li>
            <a href="https://conwaylife.com/forums/viewtopic.php?f=2&t=6808">
              The 323: A 32-bit computer - ConwayLife.com forums
            </a>
          </li>
          <li>
            <a href="https://github.com/rei1024/323-web-emulator">
              Source code for 323 Web Emulator - GitHub
            </a>
          </li>
        </ul>
      </section>
    </footer>
  </body>
</html>
